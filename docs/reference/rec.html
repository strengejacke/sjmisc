<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Recode variables — rec • sjmisc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Recode variables — rec" />

<meta property="og:description" content="rec() recodes values of variables, where variable
  selection is based on variable names or column position, or on
  select helpers (see documentation on ...). rec_if() is a
  scoped variant of rec(), where recoding will be applied only
  to those variables that match the logical condition of predicate." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sjmisc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.7.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/design_philosophy.html">The Design Philosophy of Functions in sjmisc</a>
    </li>
    <li>
      <a href="../articles/exploringdatasets.html">Exploring Data Sets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/strengejacke/sjmisc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recode variables</h1>
    <small class="dont-index">Source: <a href='https://github.com/strengejacke/sjmisc/blob/master/R/rec.R'><code>R/rec.R</code></a></small>
    <div class="hidden name"><code>rec.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>rec()</code> recodes values of variables, where variable
  selection is based on variable names or column position, or on
  select helpers (see documentation on <code>...</code>). <code>rec_if()</code> is a
  scoped variant of <code>rec()</code>, where recoding will be applied only
  to those variables that match the logical condition of <code>predicate</code>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>rec</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='no'>rec</span>, <span class='kw'>as.num</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>var.label</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>val.labels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='st'>"_r"</span>)

<span class='fu'>rec_if</span>(<span class='no'>x</span>, <span class='no'>predicate</span>, <span class='no'>rec</span>, <span class='kw'>as.num</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>var.label</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>val.labels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='st'>"_r"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A vector or data frame.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional, unquoted names of variables that should be selected for
further processing. Required, if <code>x</code> is a data frame (and no
vector) and only selected variables from <code>x</code> should be processed.
You may also use functions like <code>:</code> or tidyselect's
<code><a href='http://www.rdocumentation.org/packages/tidyselect/topics/select_helpers'>select_helpers</a></code>.
See 'Examples' or <a href='../doc/design_philosophy.html'>package-vignette</a>.</p></td>
    </tr>
    <tr>
      <th>rec</th>
      <td><p>String with recode pairs of old and new values. See 'Details'
for examples. <code><a href='rec_pattern.html'>rec_pattern</a></code> is a convenient function to
create recode strings for grouping variables.</p></td>
    </tr>
    <tr>
      <th>as.num</th>
      <td><p>Logical, if <code>TRUE</code>, return value will be numeric, not a factor.</p></td>
    </tr>
    <tr>
      <th>var.label</th>
      <td><p>Optional string, to set variable label attribute for the
returned variable (see vignette <a href='https://cran.r-project.org/package=sjlabelled/vignettes/intro_sjlabelled.html'>Labelled Data and the sjlabelled-Package</a>).
If <code>NULL</code> (default), variable label attribute of <code>x</code> will
be used (if present). If empty, variable label attributes will be removed.</p></td>
    </tr>
    <tr>
      <th>val.labels</th>
      <td><p>Optional character vector, to set value label attributes
of recoded variable (see vignette <a href='https://cran.r-project.org/package=sjlabelled/vignettes/intro_sjlabelled.html'>Labelled Data and the sjlabelled-Package</a>).
If <code>NULL</code> (default), no value labels will be set. Value labels
can also be directly defined in the <code>rec</code>-syntax, see
'Details'.</p></td>
    </tr>
    <tr>
      <th>append</th>
      <td><p>Logical, if <code>TRUE</code> (the default) and <code>x</code> is a data frame,
<code>x</code> including the new variables as additional columns is returned;
if <code>FALSE</code>, only the new variables are returned.</p></td>
    </tr>
    <tr>
      <th>suffix</th>
      <td><p>String value, will be appended to variable (column) names of
<code>x</code>, if <code>x</code> is a data frame. If <code>x</code> is not a data
frame, this argument will be ignored. The default value to suffix
column names in a data frame depends on the function call:</p><ul>
<li><p>recoded variables (<code>rec()</code>) will be suffixed with <code>"_r"</code></p></li>
<li><p>recoded variables (<code><a href='recode_to.html'>recode_to()</a></code>) will be suffixed with <code>"_r0"</code></p></li>
<li><p>dichotomized variables (<code><a href='dicho.html'>dicho()</a></code>) will be suffixed with <code>"_d"</code></p></li>
<li><p>grouped variables (<code><a href='split_var.html'>split_var()</a></code>) will be suffixed with <code>"_g"</code></p></li>
<li><p>grouped variables (<code><a href='group_var.html'>group_var()</a></code>) will be suffixed with <code>"_gr"</code></p></li>
<li><p>standardized variables (<code><a href='std.html'>std()</a></code>) will be suffixed with <code>"_z"</code></p></li>
<li><p>centered variables (<code><a href='std.html'>center()</a></code>) will be suffixed with <code>"_c"</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>predicate</th>
      <td><p>A predicate function to be applied to the columns. The
variables for which <code>predicate</code> returns <code>TRUE</code> are selected.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>x</code> with recoded categories. If <code>x</code> is a data frame,
  for <code>append = TRUE</code>, <code>x</code> including the recoded variables
  as new columns is returned; if <code>append = FALSE</code>, only
  the recoded variables will be returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>rec</code> string has following syntax:</p><dl class='dl-horizontal'>
    <dt>recode pairs</dt><dd><p>each recode pair has to be separated by a <code>;</code>, e.g. <code>rec = "1=1; 2=4; 3=2; 4=3"</code></p></dd>
    <dt>multiple values</dt><dd><p>multiple old values that should be recoded into a new single value may be separated with comma, e.g. <code>"1,2=1; 3,4=2"</code></p></dd>
    <dt>value range</dt><dd><p>a value range is indicated by a colon, e.g. <code>"1:4=1; 5:8=2"</code> (recodes all values from 1 to 4 into 1, and from 5 to 8 into 2)</p></dd>
    <dt>value range for doubles</dt><dd><p>for double vectors (with floating points), all values within the specified range are recoded; e.g. <code>1:2.5=1;2.6:3=2</code> recodes 1 to 2.5 into 1 and 2.6 to 3 into 2, but 2.55 would not be recoded (since it's not included in any of the specified ranges)</p></dd>
    <dt><code>"min"</code> and <code>"max"</code></dt><dd><p>minimum and maximum values are indicates by <em>min</em> (or <em>lo</em>) and <em>max</em> (or <em>hi</em>), e.g. <code>"min:4=1; 5:max=2"</code> (recodes all values from minimum values of <code>x</code> to 4 into 1, and from 5 to maximum values of <code>x</code> into 2)</p></dd>
    <dt><code>"else"</code></dt><dd><p>all other values, which have not been specified yet, are indicated by <em>else</em>, e.g. <code>"3=1; 1=2; else=3"</code> (recodes 3 into 1, 1 into 2 and all other values into 3)</p></dd>
    <dt><code>"copy"</code></dt><dd><p>the <code>"else"</code>-token can be combined with <em>copy</em>, indicating that all remaining, not yet recoded values should stay the same (are copied from the original value), e.g. <code>"3=1; 1=2; else=copy"</code> (recodes 3 into 1, 1 into 2 and all other values like 2, 4 or 5 etc. will not be recoded, but copied, see 'Examples')</p></dd>
    <dt><code>NA</code>'s</dt><dd><p><code>NA</code> values are allowed both as old and new value, e.g. <code>"NA=1; 3:5=NA"</code> (recodes all NA into 1, and all values from 3 to 5 into NA in the new variable)</p></dd>
    <dt><code>"rev"</code></dt><dd><p><code>"rev"</code> is a special token that reverses the value order (see 'Examples')</p></dd>
    <dt>direct value labelling</dt><dd><p>value labels for new values can be assigned inside the recode pattern by writing the value label in square brackets after defining the new value in a recode pair, e.g. <code>"15:30=1 [young aged]; 31:55=2 [middle aged]; 56:max=3 [old aged]"</code>. See 'Examples'.</p></dd>
  </dl>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Please note following behaviours of the function:</p><ul>
<li><p>the <code>"else"</code>-token should always be the last argument in the <code>rec</code>-string.</p></li>
<li><p>Non-matching values will be set to <code>NA</code>, unless captured by the <code>"else"</code>-token.</p></li>
<li><p>Tagged NA values (see <code><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>tagged_na</a></code>) and their value labels will be preserved when copying NA values to the recoded vector with <code>"else=copy"</code>.</p></li>
<li><p>Variable label attributes (see, for instance, <code><a href='http://www.rdocumentation.org/packages/sjlabelled/topics/get_label'>get_label</a></code>) are preserved (unless changed via <code>var.label</code>-argument), however, value label attributes are removed (except for <code>"rev"</code>, where present value labels will be automatically reversed as well). Use <code>val.labels</code>-argument to add labels for recoded values.</p></li>
<li><p>If <code>x</code> is a data frame, all variables should have the same categories resp. value range (else, see second bullet, <code>NA</code>s are produced).</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='set_na.html'>set_na</a></code> for setting <code>NA</code> values, <code><a href='replace_na.html'>replace_na</a></code>
           to replace <code>NA</code>'s with specific value, <code><a href='recode_to.html'>recode_to</a></code>
           for re-shifting value ranges and <code><a href='ref_lvl.html'>ref_lvl</a></code> to change the
           reference level of (numeric) factors.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>efc</span>)
<span class='fu'>table</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2    3    4 &lt;NA&gt; 
#&gt;   66  225  306  304    7 </div><div class='input'>
<span class='co'># replace NA with 5</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1=1;2=2;3=3;4=4;NA=5"</span>), <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2    3    4    5 &lt;NA&gt; 
#&gt;   66  225  306  304    7    0 </div><div class='input'>
<span class='co'># recode 1 to 2 into 1 and 3 to 4 into 2</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1,2=1; 3,4=2"</span>), <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2 &lt;NA&gt; 
#&gt;  291  610    7 </div><div class='input'>
<span class='co'># keep value labels. variable label is automatically preserved</span>
<span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='no'>efc</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>e42dep</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>rec</span>(<span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1,2=1; 3,4=2"</span>,
      <span class='kw'>val.labels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"low dependency"</span>, <span class='st'>"high dependency"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'>str</span>()</div><div class='output co'>#&gt; Classes ‘tbl_df’, ‘tbl’ and 'data.frame':	908 obs. of  2 variables:
#&gt;  $ e42dep  : num  3 3 3 4 4 4 4 4 4 4 ...
#&gt;   ..- attr(*, "label")= chr "elder's dependency"
#&gt;   ..- attr(*, "labels")= Named num  1 2 3 4
#&gt;   .. ..- attr(*, "names")= chr  "independent" "slightly dependent" "moderately dependent" "severely dependent"
#&gt;  $ e42dep_r: num  2 2 2 2 2 2 2 2 2 2 ...
#&gt;   ..- attr(*, "label")= chr "elder's dependency"
#&gt;   ..- attr(*, "labels")= Named num  1 2
#&gt;   .. ..- attr(*, "names")= chr  "low dependency" "high dependency"</div><div class='input'>
<span class='co'># works with mutate</span>
<span class='no'>efc</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>e42dep</span>, <span class='no'>e17age</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>dependency_rev</span> <span class='kw'>=</span> <span class='fu'>rec</span>(<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"rev"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'>head</span>()</div><div class='output co'>#&gt;   e42dep e17age dependency_rev
#&gt; 1      3     83              2
#&gt; 2      3     88              2
#&gt; 3      3     82              2
#&gt; 4      4     67              1
#&gt; 5      4     84              1
#&gt; 6      4     85              1</div><div class='input'>
<span class='co'># recode 1 to 3 into 4 into 2</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"min:3=1; 4=2"</span>), <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2 &lt;NA&gt; 
#&gt;  597  304    7 </div><div class='input'>
<span class='co'># recode 2 to 1 and all others into 2</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"2=1; else=2"</span>), <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2 &lt;NA&gt; 
#&gt;  225  676    7 </div><div class='input'>
<span class='co'># reverse value order</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"rev"</span>), <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>)</div><div class='output co'>#&gt; 
#&gt;    1    2    3    4 &lt;NA&gt; 
#&gt;  304  306  225   66    7 </div><div class='input'>
<span class='co'># recode only selected values, copy remaining</span>
<span class='fu'>table</span>(<span class='no'>efc</span>$<span class='no'>e15relat</span>)</div><div class='output co'>#&gt; 
#&gt;   1   2   3   4   5   6   7   8 
#&gt; 171 473  29  85  23  22   6  92 </div><div class='input'><span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e15relat</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1,2,4=1; else=copy"</span>))</div><div class='output co'>#&gt; 
#&gt;   1   3   5   6   7   8 
#&gt; 729  29  23  22   6  92 </div><div class='input'>
<span class='co'># recode variables with same category in a data frame</span>
<span class='fu'>head</span>(<span class='no'>efc</span>[, <span class='fl'>6</span>:<span class='fl'>9</span>])</div><div class='output co'>#&gt;   c82cop1 c83cop2 c84cop3 c85cop4
#&gt; 1       3       2       2       2
#&gt; 2       3       3       3       3
#&gt; 3       2       2       1       4
#&gt; 4       4       1       3       1
#&gt; 5       3       2       1       2
#&gt; 6       2       2       3       3</div><div class='input'><span class='fu'>head</span>(<span class='fu'>rec</span>(<span class='no'>efc</span>[, <span class='fl'>6</span>:<span class='fl'>9</span>], <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1=10;2=20;3=30;4=40"</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 8
#&gt;   c82cop1 c83cop2 c84cop3 c85cop4 c82cop1_r c83cop2_r c84cop3_r c85cop4_r
#&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1       3       2       2       2        30        20        20        20
#&gt; 2       3       3       3       3        30        30        30        30
#&gt; 3       2       2       1       4        20        20        10        40
#&gt; 4       4       1       3       1        40        10        30        10
#&gt; 5       3       2       1       2        30        20        10        20
#&gt; 6       2       2       3       3        20        20        30        30</div><div class='input'>
<span class='co'># recode multiple variables and set value labels via recode-syntax</span>
<span class='no'>dummy</span> <span class='kw'>&lt;-</span> <span class='fu'>rec</span>(
  <span class='no'>efc</span>, <span class='no'>c160age</span>, <span class='no'>e17age</span>,
  <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"15:30=1 [young]; 31:55=2 [middle]; 56:max=3 [old]"</span>,
  <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='fu'><a href='frq.html'>frq</a></span>(<span class='no'>dummy</span>)</div><div class='output co'>#&gt; 
#&gt; # carer' age (c160age_r) &lt;numeric&gt; 
#&gt; # total N=908  valid N=901  mean=2.40  sd=0.59
#&gt;  
#&gt;  val  label frq raw.prc valid.prc cum.prc
#&gt;    1  young  48    5.29      5.33    5.33
#&gt;    2 middle 442   48.68     49.06   54.38
#&gt;    3    old 411   45.26     45.62  100.00
#&gt;   NA     NA   7    0.77        NA      NA
#&gt; 
#&gt; 
#&gt; # elder' age (e17age_r) &lt;numeric&gt; 
#&gt; # total N=908  valid N=891  mean=3.00  sd=0.00
#&gt;  
#&gt;  val  label frq raw.prc valid.prc cum.prc
#&gt;    1  young   0    0.00         0       0
#&gt;    2 middle   0    0.00         0       0
#&gt;    3    old 891   98.13       100     100
#&gt;   NA     NA  17    1.87        NA      NA
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># recode variables with same value-range</span>
<span class='fu'>lapply</span>(
  <span class='fu'>rec</span>(
    <span class='no'>efc</span>, <span class='no'>c82cop1</span>, <span class='no'>c83cop2</span>, <span class='no'>c84cop3</span>,
    <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1,2=1; NA=9; else=copy"</span>,
    <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
  ),
  <span class='no'>table</span>,
  <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"always"</span>
)</div><div class='output co'>#&gt; $c82cop1_r
#&gt; 
#&gt;    1    3    4    9 &lt;NA&gt; 
#&gt;  100  591  210    7    0 
#&gt; 
#&gt; $c83cop2_r
#&gt; 
#&gt;    1    3    4    9 &lt;NA&gt; 
#&gt;  733  130   39    6    0 
#&gt; 
#&gt; $c84cop3_r
#&gt; 
#&gt;    1    3    4    9 &lt;NA&gt; 
#&gt;  768   82   52    6    0 
#&gt; </div><div class='input'>
<span class='co'># recode character vector</span>
<span class='no'>dummy</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"M"</span>, <span class='st'>"F"</span>, <span class='st'>"F"</span>, <span class='st'>"X"</span>)
<span class='fu'>rec</span>(<span class='no'>dummy</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"M=Male; F=Female; X=Refused"</span>)</div><div class='output co'>#&gt; [1] "Male"    "Female"  "Female"  "Refused"</div><div class='input'>
<span class='co'># recode numeric to character</span>
<span class='fu'>rec</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1=first;2=2nd;3=third;else=hi"</span>)</div><div class='output co'>#&gt;   [1] "third" "third" "third" "4"     "4"     "4"     "4"     "4"     "4"    
#&gt;  [10] "4"     "4"     "third" "4"     "third" "third" "third" "first" "third"
#&gt;  [19] "third" "4"     "4"     "third" "4"     "4"     "third" "4"     "4"    
#&gt;  [28] "2nd"   "third" "4"     "4"     "4"     "third" "4"     "4"     "4"    
#&gt;  [37] "4"     "2nd"   "4"     "third" "third" "4"     "4"     "4"     "4"    
#&gt;  [46] "4"     "4"     "4"     "third" "4"     "4"     "4"     "4"     "4"    
#&gt;  [55] "4"     "4"     "4"     "4"     "third" "4"     "4"     "4"     "4"    
#&gt;  [64] "third" "third" "third" "4"     "third" "4"     "4"     "4"     "4"    
#&gt;  [73] "4"     "4"     "4"     "4"     "4"     "third" "third" "4"     "2nd"  
#&gt;  [82] "third" "4"     "third" "4"     "4"     "4"     "4"     "4"     "4"    
#&gt;  [91] "third" "first" "2nd"   "third" "4"     "third" NA      "4"     "third"
#&gt; [100] "4"     "third" "third" "third" "4"     "4"     "third" "third" "2nd"  
#&gt; [109] "third" "4"     "4"     "third" "4"     "4"     "4"     "2nd"   "2nd"  
#&gt; [118] "third" "4"     "4"     "third" "4"     "4"     "4"     "third" "4"    
#&gt; [127] "first" "4"     "2nd"   "4"     "third" "third" "4"     "4"     "third"
#&gt; [136] "third" "4"     "2nd"   "4"     "third" "2nd"   "4"     "4"     "third"
#&gt; [145] "4"     "4"     "4"     "4"     "4"     "third" "4"     "4"     "4"    
#&gt; [154] "4"     "4"     "third" "third" "4"     "third" "third" "third" "third"
#&gt; [163] "4"     "4"     "third" "4"     "4"     "4"     "third" "4"     "third"
#&gt; [172] "third" "third" "third" "4"     "4"     "third" "4"     "4"     "4"    
#&gt; [181] "4"     "third" "third" "4"     "4"     "4"     "4"     "4"     "2nd"  
#&gt; [190] "third" "third" "4"     "2nd"   "4"     "third" "third" "2nd"   "4"    
#&gt; [199] "2nd"   "third" "third" "4"     "third" "4"     "third" "third" "4"    
#&gt; [208] "4"     "third" "third" "third" "4"     "4"     "4"     "2nd"   "third"
#&gt; [217] "4"     "4"     "4"     "2nd"   "third" "4"     "4"     "third" "4"    
#&gt; [226] "third" "4"     "third" "third" "third" "third" "third" "4"     "third"
#&gt; [235] "4"     "4"     "third" "2nd"   "third" "2nd"   "first" "third" "third"
#&gt; [244] "2nd"   "2nd"   "third" "first" "2nd"   "third" "2nd"   "third" "third"
#&gt; [253] "third" "4"     "first" "third" "third" "4"     "2nd"   "2nd"   "2nd"  
#&gt; [262] "4"     "4"     "third" "third" "4"     "third" "third" "third" "third"
#&gt; [271] "2nd"   "third" "2nd"   "2nd"   "third" "third" "third" "third" "2nd"  
#&gt; [280] "third" "third" "2nd"   "2nd"   "2nd"   "third" "third" "4"     "4"    
#&gt; [289] "4"     "4"     "2nd"   "2nd"   "third" "4"     "third" "2nd"   "third"
#&gt; [298] "third" "2nd"   "2nd"   "4"     "4"     "third" "2nd"   "2nd"   "third"
#&gt; [307] "4"     "2nd"   "third" "first" "third" "third" "third" "4"     "third"
#&gt; [316] "third" "4"     "4"     "third" "2nd"   "third" "third" "2nd"   "4"    
#&gt; [325] "2nd"   "third" "third" "third" "first" "first" "2nd"   "4"     "4"    
#&gt; [334] "4"     "third" "2nd"   "2nd"   "third" "third" "2nd"   "2nd"   "2nd"  
#&gt; [343] "2nd"   "2nd"   "third" "4"     "third" "4"     "first" "2nd"   "4"    
#&gt; [352] "2nd"   "2nd"   "2nd"   "third" "third" "4"     "third" "third" "2nd"  
#&gt; [361] "third" "third" "2nd"   "third" "2nd"   "first" "first" "2nd"   "2nd"  
#&gt; [370] "2nd"   "2nd"   "4"     "4"     "first" "2nd"   "2nd"   "2nd"   "third"
#&gt; [379] "4"     "4"     "4"     "third" "third" "4"     "third" "2nd"   "2nd"  
#&gt; [388] "4"     "third" "4"     "4"     "third" "first" "third" "2nd"   "4"    
#&gt; [397] "2nd"   "2nd"   "4"     "2nd"   "4"     "4"     "4"     "2nd"   "first"
#&gt; [406] "2nd"   "4"     "2nd"   "4"     "third" "4"     "first" "first" "2nd"  
#&gt; [415] "2nd"   "third" "2nd"   "4"     "4"     "third" "4"     "third" "4"    
#&gt; [424] "third" "4"     "4"     "2nd"   "4"     "4"     "4"     "first" "third"
#&gt; [433] "2nd"   "2nd"   "third" "2nd"   "third" "4"     "4"     "third" "third"
#&gt; [442] "2nd"   "third" "third" "2nd"   "4"     "third" "4"     "third" "third"
#&gt; [451] "third" "2nd"   "third" "third" "third" "4"     "2nd"   "4"     "third"
#&gt; [460] "third" "third" "2nd"   "4"     "third" "4"     "4"     "4"     "first"
#&gt; [469] "third" "2nd"   "4"     "first" "first" "first" "first" "first" "4"    
#&gt; [478] "2nd"   "first" "third" "4"     "third" "4"     "2nd"   "third" "third"
#&gt; [487] "third" "first" "first" "third" "2nd"   "third" "4"     "2nd"   "third"
#&gt; [496] "2nd"   "2nd"   "third" "third" "2nd"   "4"     "4"     "third" "4"    
#&gt; [505] "4"     "4"     "third" "third" "third" "third" "2nd"   "third" "2nd"  
#&gt; [514] "2nd"   "third" "third" "4"     "4"     "4"     "2nd"   "2nd"   "4"    
#&gt; [523] "third" "2nd"   "2nd"   "third" "first" "2nd"   "third" "2nd"   "4"    
#&gt; [532] "first" "4"     "third" "2nd"   "2nd"   "third" "4"     "third" "4"    
#&gt; [541] "4"     "2nd"   "third" "2nd"   "third" "third" "2nd"   "4"     "third"
#&gt; [550] "2nd"   "third" "2nd"   "2nd"   "third" "third" "third" "4"     "4"    
#&gt; [559] "4"     "2nd"   "4"     "2nd"   "4"     "2nd"   "third" "first" "2nd"  
#&gt; [568] "third" "4"     "4"     "4"     "4"     "4"     "4"     "4"     "third"
#&gt; [577] "4"     "2nd"   "4"     "third" "4"     "third" "third" "third" "2nd"  
#&gt; [586] "2nd"   "third" "4"     "4"     "4"     "first" "4"     "4"     "third"
#&gt; [595] "4"     "4"     "4"     "2nd"   "4"     "4"     "third" "4"     "third"
#&gt; [604] "2nd"   "2nd"   "2nd"   "2nd"   "first" "2nd"   "2nd"   "4"     "4"    
#&gt; [613] "4"     "4"     "4"     "4"     "third" "third" "third" "third" "third"
#&gt; [622] "first" "third" "third" "4"     "third" "4"     "4"     "2nd"   "third"
#&gt; [631] "third" "4"     "2nd"   "third" "4"     "third" "third" "third" "2nd"  
#&gt; [640] "third" "third" "third" "third" "2nd"   "2nd"   "third" "2nd"   "4"    
#&gt; [649] "2nd"   "2nd"   "2nd"   "4"     "4"     "4"     "first" "4"     "third"
#&gt; [658] "2nd"   "third" "third" "2nd"   "2nd"   "2nd"   "third" "first" "third"
#&gt; [667] "first" "2nd"   "2nd"   "third" "third" "2nd"   "third" "4"     "4"    
#&gt; [676] "first" "4"     "4"     "first" "third" "first" "2nd"   "2nd"   "4"    
#&gt; [685] "third" "first" "third" "third" "2nd"   "4"     "4"     "third" "4"    
#&gt; [694] "third" "4"     "4"     "third" "4"     "third" "4"     "third" "2nd"  
#&gt; [703] "first" "2nd"   "2nd"   "4"     "2nd"   "2nd"   "third" "first" "2nd"  
#&gt; [712] "4"     "third" "4"     "4"     "4"     "4"     "2nd"   "first" "4"    
#&gt; [721] "2nd"   "2nd"   "third" "4"     "third" "2nd"   "4"     "2nd"   "third"
#&gt; [730] "third" "third" "4"     "2nd"   "4"     "2nd"   "third" "2nd"   "third"
#&gt; [739] "2nd"   "first" "4"     "third" "third" "third" "4"     "2nd"   "2nd"  
#&gt; [748] "2nd"   "third" "third" "4"     "4"     "4"     "4"     "4"     "first"
#&gt; [757] "2nd"   "4"     "4"     "2nd"   "2nd"   "third" "2nd"   "2nd"   "2nd"  
#&gt; [766] "2nd"   "third" "third" "first" "2nd"   "first" "first" "2nd"   "third"
#&gt; [775] "2nd"   "first" "third" "third" "2nd"   "2nd"   "2nd"   "2nd"   "third"
#&gt; [784] "third" "third" "third" "4"     "2nd"   "4"     "first" "first" "first"
#&gt; [793] "2nd"   "4"     "2nd"   "2nd"   "2nd"   "2nd"   "first" "third" "2nd"  
#&gt; [802] "4"     "third" "4"     "2nd"   "third" "4"     "third" "4"     "third"
#&gt; [811] "third" "third" "2nd"   "third" "2nd"   "2nd"   "third" "first" "first"
#&gt; [820] "third" "first" "2nd"   "2nd"   "third" "2nd"   "2nd"   "2nd"   "third"
#&gt; [829] "2nd"   "4"     "first" "third" "first" "third" "first" "2nd"   "first"
#&gt; [838] "2nd"   "2nd"   "third" "4"     "2nd"   "2nd"   "2nd"   "first" "2nd"  
#&gt; [847] "2nd"   "2nd"   "2nd"   "2nd"   "2nd"   "4"     "third" "first" "4"    
#&gt; [856] "2nd"   "third" "third" "2nd"   "2nd"   "2nd"   "third" "first" "2nd"  
#&gt; [865] "third" "third" "2nd"   "2nd"   "2nd"   "first" "2nd"   "2nd"   "2nd"  
#&gt; [874] "third" "2nd"   "2nd"   "4"     "third" "4"     "2nd"   "third" "first"
#&gt; [883] "2nd"   "third" "third" "2nd"   "4"     "third" "third" "2nd"   "2nd"  
#&gt; [892] "third" "third" "third" "4"     "2nd"   "4"     "third" "third" "4"    
#&gt; [901] "first" "2nd"   NA      NA      NA      NA      NA      NA     
#&gt; attr(,"label")
#&gt; [1] "elder's dependency"</div><div class='input'>
<span class='co'># recode non-numeric factors</span>
<span class='fu'>data</span>(<span class='no'>iris</span>)
<span class='fu'>table</span>(<span class='fu'>rec</span>(<span class='no'>iris</span>, <span class='no'>Species</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"setosa=huhu; else=copy"</span>, <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; 
#&gt;       huhu versicolor  virginica 
#&gt;         50         50         50 </div><div class='input'>
<span class='co'># recode floating points</span>
<span class='fu'>table</span>(<span class='fu'>rec</span>(
  <span class='no'>iris</span>, <span class='no'>Sepal.Length</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"lo:5=1;5.01:6.5=2;6.501:max=3"</span>, <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
))</div><div class='output co'>#&gt; 
#&gt;  1  2  3 
#&gt; 32 88 30 </div><div class='input'>
<span class='co'># preserve tagged NAs</span>
<span class='fu'>library</span>(<span class='no'>haven</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/labelled'>labelled</a></span>(<span class='fu'>c</span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>tagged_na</a></span>(<span class='st'>"a"</span>, <span class='st'>"c"</span>, <span class='st'>"z"</span>), <span class='fl'>4</span>:<span class='fl'>1</span>),
              <span class='fu'>c</span>(<span class='st'>"Agreement"</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='st'>"Disagreement"</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='st'>"First"</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>tagged_na</a></span>(<span class='st'>"c"</span>),
                <span class='st'>"Refused"</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>tagged_na</a></span>(<span class='st'>"a"</span>), <span class='st'>"Not home"</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>tagged_na</a></span>(<span class='st'>"z"</span>)))
<span class='co'># get current value labels</span>
<span class='no'>x</span></div><div class='output co'>#&gt; &lt;Labelled double&gt;
#&gt;  [1]     1     2     3 NA(a) NA(c) NA(z)     4     3     2     1
#&gt; 
#&gt; Labels:
#&gt;  value        label
#&gt;      1    Agreement
#&gt;      4 Disagreement
#&gt;  NA(c)        First
#&gt;  NA(a)      Refused
#&gt;  NA(z)     Not home</div><div class='input'><span class='co'># recode 2 into 5; Values of tagged NAs are preserved</span>
<span class='fu'>rec</span>(<span class='no'>x</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"2=5;else=copy"</span>)</div><div class='output co'>#&gt;  [1]  1  5  3 NA NA NA  4  3  5  1
#&gt; attr(,"labels")
#&gt;    First  Refused Not home 
#&gt;       NA       NA       NA </div><div class='input'><span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/tagged_na'>na_tag</a></span>(<span class='fu'>rec</span>(<span class='no'>x</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"2=5;else=copy"</span>))</div><div class='output co'>#&gt;  [1] NA  NA  NA  "a" "c" "z" NA  NA  NA  NA </div><div class='input'>
<span class='co'># use select-helpers from dplyr-package</span>
<span class='fu'>rec</span>(
  <span class='no'>efc</span>, <span class='fu'><a href='http://dplyr.tidyverse.org/reference/reexports.html'>contains</a></span>(<span class='st'>"cop"</span>), <span class='no'>c161sex</span>:<span class='no'>c175empl</span>,
  <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"0,1=0; else=1"</span>,
  <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</div><div class='output co'>#&gt; # A tibble: 908 x 12
#&gt;    c82cop1_r c83cop2_r c84cop3_r c85cop4_r c86cop5_r c87cop6_r c88cop7_r
#&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1         1         1         1         1         0         0         1
#&gt;  2         1         1         1         1         1         0         1
#&gt;  3         1         1         0         1         0         0         0
#&gt;  4         1         0         1         0         0         0         0
#&gt;  5         1         1         0         1         1         1         0
#&gt;  6         1         1         1         1         1         1         1
#&gt;  7         1         1         1         0         0         1         1
#&gt;  8         1         1         1         0         0         0         1
#&gt;  9         1         1         1         1         1         0         1
#&gt; 10         1         1         0         1         0         0         0
#&gt; # ... with 898 more rows, and 5 more variables: c89cop8_r &lt;dbl&gt;,
#&gt; #   c90cop9_r &lt;dbl&gt;, c161sex_r &lt;dbl&gt;, c172code_r &lt;dbl&gt;, c175empl_r &lt;dbl&gt;</div><div class='input'>
<span class='co'># recode only variables that have a value range from 1-4</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>min</span>(<span class='no'>x</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>&gt;</span> <span class='fl'>0</span> <span class='kw'>&amp;&amp;</span> <span class='fu'>max</span>(<span class='no'>x</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>&lt;</span> <span class='fl'>5</span>
<span class='fu'>rec_if</span>(<span class='no'>efc</span>, <span class='kw'>predicate</span> <span class='kw'>=</span> <span class='no'>p</span>, <span class='kw'>rec</span> <span class='kw'>=</span> <span class='st'>"1:3=1;4=2;else=copy"</span>)</div><div class='output co'>#&gt; # A tibble: 908 x 40
#&gt;    c12hour e15relat e16sex e17age e42dep c82cop1 c83cop2 c84cop3 c85cop4
#&gt;      &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1      16        2      2     83      3       3       2       2       2
#&gt;  2     148        2      2     88      3       3       3       3       3
#&gt;  3      70        1      2     82      3       2       2       1       4
#&gt;  4     168        1      2     67      4       4       1       3       1
#&gt;  5     168        2      2     84      4       3       2       1       2
#&gt;  6      16        2      2     85      4       2       2       3       3
#&gt;  7     161        1      1     74      4       4       2       4       1
#&gt;  8     110        4      2     87      4       3       2       2       1
#&gt;  9      28        2      2     79      4       3       2       3       2
#&gt; 10      40        2      2     83      4       3       2       1       2
#&gt; # ... with 898 more rows, and 31 more variables: c86cop5 &lt;dbl&gt;, c87cop6 &lt;dbl&gt;,
#&gt; #   c88cop7 &lt;dbl&gt;, c89cop8 &lt;dbl&gt;, c90cop9 &lt;dbl&gt;, c160age &lt;dbl&gt;, c161sex &lt;dbl&gt;,
#&gt; #   c172code &lt;dbl&gt;, c175empl &lt;dbl&gt;, barthtot &lt;dbl&gt;, neg_c_7 &lt;dbl&gt;,
#&gt; #   pos_v_4 &lt;dbl&gt;, quol_5 &lt;dbl&gt;, resttotn &lt;dbl&gt;, tot_sc_e &lt;dbl&gt;, n4pstu &lt;dbl&gt;,
#&gt; #   nur_pst &lt;dbl&gt;, e16sex_r &lt;dbl&gt;, e42dep_r &lt;dbl&gt;, c82cop1_r &lt;dbl&gt;,
#&gt; #   c83cop2_r &lt;dbl&gt;, c84cop3_r &lt;dbl&gt;, c85cop4_r &lt;dbl&gt;, c86cop5_r &lt;dbl&gt;,
#&gt; #   c87cop6_r &lt;dbl&gt;, c88cop7_r &lt;dbl&gt;, c89cop8_r &lt;dbl&gt;, c90cop9_r &lt;dbl&gt;,
#&gt; #   c161sex_r &lt;dbl&gt;, c172code_r &lt;dbl&gt;, nur_pst_r &lt;dbl&gt;</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Lüdecke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

